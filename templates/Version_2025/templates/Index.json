{"content":"var row_per_page = (ccpcm_global.showProjections == true)?11:12; \/\/#43 9:10;\n\nvar styles = {\n  \n};\n\n\/\/ Legend\nvar legendsFontSize = 4.1;\nvar filmIconFontSize = 6;\nvar eventsColor = [0,0,0,75];\nvar evenBackgroundColor = [0,0,0,3];\nvar infosColor = [100,0,50,0];\n\nvar tag_colors = {\n\t'Avant-premi\u00e8re': ccpcm_global.editionColor,\n  \t'S\u00e9ance commerciale': [100, 0, 0, 0],\n};\n\nvar legends = [];\nif ( data.sections != undefined )\n$.each(data.sections, function(idx, section) {\n  \t\/\/console.log(section);\n  \t\/\/if ( section.name != 'Comp\u00e9tition courts m\u00e9trages')\n    if ($.inArray(section.term_id, [\n    \/\/parseInt(ccpcm_global.competitionID), \n    parseInt(ccpcm_global.competitionLMID), \n    parseInt(ccpcm_global.competitionDCID), \n    parseInt(ccpcm_global.competitionCMID), \n    parseInt(ccpcm_global.competitionCM1ID), \n    parseInt(ccpcm_global.competitionCM2ID), \n    parseInt(ccpcm_global.competitionCM3ID),\n    parseInt(ccpcm_global.currentEditionID)\n             ]) == -1)\n      if ( section.parent == parseInt(ccpcm_global.currentEditionID) )\n\t\tlegends.push({text: \"\u2022 \\n\"+section.name, color: section.color, fontSize: legendsFontSize});\n});\n\/\/legends.push({text: [{text:'g', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' \\nAvec invit\u00e9\u00b7e'], color: ccpcm_global.black, fontSize: legendsFontSize});\n\/\/legends.push({text: [{text:'y', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' \\nParents-enfants'], color: ccpcm_global.black, fontSize: legendsFontSize});\n\/\/ Invit\u00e9 \/ debat \nlegends.push({text: [{text:'g', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' \\nAvec invit\u00e9\u00b7e','\\n',{text:'m', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' \\nAvec d\u00e9bat'], color: ccpcm_global.black, fontSize: legendsFontSize});\n\/\/ Temps fort et parent enfant\nlegends.push({text: [{text:'s', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' \\nTemps-fort','\\n',{text:'y', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' \\nParents-enfants'], color: ccpcm_global.black, fontSize: legendsFontSize});\n\/\/ Avant-premiere & premiere \nlegends.push({text: [{text:'0', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' \\nPremi\u00e8re','\\n',{text:'5', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' \\nAvant-premi\u00e8re'], color: ccpcm_global.black, fontSize: legendsFontSize});\n\n\/\/legends.push({text: [{text:'VOSTA', style: 'filmVO'}, ' VO sous-titr\u00e9 Anglais'], color: infosColor, fontSize: legendsFontSize});\n\/\/legends.push({text: [{text:'y', font: 'Fifam', fontSize: legendsFontSize*0.75}, ' Jeune public'], color: ccpcm_global.black, fontSize: legendsFontSize});\n\/\/legends.push({text: 'Programmation habituelle de la salle', color: tag_colors['S\u00e9ance commerciale'], fontSize: legendsFontSize});\n\/\/legends.push({text: 'Avant premi\u00e8re', color: tag_colors['Avant-premi\u00e8re'], fontSize: legendsFontSize});\n\/\/legends.push({text: '\u00c9venement', color: eventsColor, fontSize: legendsFontSize});\n\nfunction sortOnKeys(dict) {\n    var sorted = [];\n    for(var key in dict) {\n        sorted[sorted.length] = key;\n    }\n    sorted.sort();\n    var tempDict = {};\n    for(var i = 0; i \u003C sorted.length; i++) {\n        tempDict[sorted[i]] = dict[sorted[i]];\n    }\n    return tempDict;\n}\n\n\/\/console.log(data);\nvar dd = [];\nvar _d = [];\nvar index_title = 'Index | A \u00e0 Z';\nvar borderBottomWidth = .25;\nvar tableCell1 = 33;\nvar tableCell2 = 15;\n\n\nvar content_width = (ccpcm_global.pageSize.width - ccpcm_global.insideMargins[0] - ccpcm_global.insideMargins[2] - ccpcm_global.cropMarksLength * 2);\n\n\/\/dd.push({text: index_title, tocItem: true, contentTab: ccpcm_global.set_tab({title: index_title}), absolutePosition: {x:0, y:-1000}});\n\ndd.push({text: index_title, style: 'intertitre', tocItem: true, tocMargin: ccpcm_global.tocMarginLevel1, tocStyle: ccpcm_global.tocStyleLevel1, contentTab: ccpcm_global.set_tab({title: index_title, subtitle: false}), absolutePosition: {x:0,y:-1000}});\/\/margin: ccpcm_global.insideMargins\n\nccpcm_global.globalIndex = sortOnKeys(ccpcm_global.globalIndex);\n\n$.each(ccpcm_global.globalIndex, function(key, value) {\n  var name = value['name'];\n  var data = value['data'];\n  if (data == false) {\n    var col2 = {pageReference: key, alignment: 'right', style:'indexPageNumber', margin:[0,4,0,0]};\n    if ($.isArray(name)) {\n      d = [];\n      $.each(name, function(idx, element) {\n          d.push(element);\n      });\n      d.push({text: ' : '});\n      _d.push([{text: d, style: 'index'},col2]);\n    } else {\n      _d.push([{text: name, style: 'index'},col2]);\n    }\n  } else {\n    var col2 = {pageReference: key, alignment: 'right', style:'indexPageNumber', margin:[0,4,0,0]};\n    if ($.isArray(name)) {\n      d = [];\n      $.each(name, function(idx, element) {\n          d.push(element);\n      });\n      d.push({text: ' : '});\n      name = d;\n      _d.push([{text: d, style: 'index'},col2]);\n    }\n\t\n    \/\/ Section color\n     var s_color = (data.color_print!='')?data.color_print:ccpcm_global.black;\n    \/\/ Film name is data.ordered_title if exists ( id = _name_simplified ) \n    \/\/ console.log(data);\n    name = (data._name_simplified != '')?data._name_simplified:name;\n    var nameLength = name.length;\n\n    _d.push([{stack: [ \n      {text: [\n      \t{text:name, style: 'titlelistindex', color: s_color, characterSpacing: (nameLength\u003E45)?-0.3:0},{text: '  \u2022', color: s_color, style: 'filmSectionIndex'},{text: '\\n', lineHeight: 1}, \n        \/\/ccpcm_global.print_contact_name = function(t_data, title, longtitle, el_last=false, el_class='articles', el_first=true, d_section=[], nonBreakableSpace=true, abbrvFirstname=false) {\n\t  \t{text: ccpcm_global.print_contact_name(data.author, 'DE', 'DE', true, 'articleslist', true, [], false, false), style: 'contactlist'}, \n      \t{text: ' \u00b7 '},\n      \t{text: ccpcm_global.print_datas(data.country, '', ' \u00b7 ','','countrylist')},\n        \/\/ #43\n      \t{text: ccpcm_global.print_datas(data.co_production_country, '', ' \u00b7 ','','countrylist')},\n      \t{text:'' + data.movie_length + '\\'', style: 'lengthlist'},\n      \t(data.is_guest)?{text : [{text: ' ', style: 'spaceBeforeIcon'},{text:'g', font: 'Fifam', style: 'filmIcon', fontSize:filmIconFontSize}]}:'',\n        \/\/ #43\n      \t(data.is_debate)?{text : [{text: ' ', style: 'spaceBeforeIcon'},{text:'m', font: 'Fifam', style: 'filmIcon', fontSize:filmIconFontSize}]}:'',\n      \t(data.young_public)?{text : [{text: ' ', style: 'spaceBeforeIcon'},{text:'y', font: 'Fifam', style: 'filmIcon', fontSize:filmIconFontSize}]}:'',\n      \t(data.is_highlighted)?{text : [{text: ' ', style: 'spaceBeforeIcon'},{text:'s', font: 'Fifam', style: 'filmIcon', fontSize:filmIconFontSize}]}:'',\n        \/\/ #43\n        (data.premiere)?{text : [{text: ' ', style: 'spaceBeforeIcon'},{text:'0', font: 'Fifam', style: 'filmIcon', fontSize:filmIconFontSize}]}:'',\n        \/\/ #43\n      \t(data.catalog_tag == 'Avant-premi\u00e8re')?{text : [{text: ' ', style: 'spaceBeforeIcon'},{text:'5', font: 'Fifam', style: 'filmIcon', fontSize:filmIconFontSize}]}:'',\n\t\t{text: '\\n', lineHeight: 1.5},\n    ], style: 'filmlistindex'},\n    \/\/ #44 Remove punchlines\n    \/*{text:data.punchline_french, style: 'index', color:[0,0,0,85]},*\/\n    {text: (ccpcm_global.showProjections == true)?ccpcm_global.print_projection(data.projections):'', style: 'projection', margin: [0, 2, 0, 4]} ],margin:[0,3,0,0]},col2]);\n  }\n});\n\n\n\/\/ Remplissage de test \n\n\/*for ( i=0; i \u003C row_per_page*2-2; i++) {\n    _d.push([{stack: [ \n      {text: [\n      \t{text:'Dakar-Djibouti 1931, le butin du mus\u00e9e de l\u2019homme', style: 'titlelistindex', color: 'orange', characterSpacing:-0.2},{text: ' \u2022', color: 'orange', style: 'filmSection'},{text: '\\n', lineHeight: 1}, \n\t  \t{text: ccpcm_global.print_contact_name([{'firstname':'Martin','lastname':'Angor'}], 'DE', 'DE', true, 'articleslist', true, [], false, 'contactlist'), style: 'contactlist'}, \n      \t{text: ' \u00b7 '},\n      \t{text: ccpcm_global.print_datas(['France'], '', '  \u00b7 ','','countrylist')},\n      \t{text:'45\\'', style: 'lengthlist'},\n      \t(1==1)?{text : [{text: ' ', style: 'spaceBeforeIcon'},{text:'g', font: 'Fifam', style: 'filmIcon', fontSize:filmIconFontSize}]}:'',\n      \t(1==1)?{text : [{text: ' ', style: 'spaceBeforeIcon'},{text:'y', font: 'Fifam', style: 'filmIcon', fontSize:filmIconFontSize}]}:'',{text: '\\n', lineHeight: 1.5},\n    ], style: 'filmlistindex'},\n    {text:'Nam quis nulla. Integer malesuada. In in enim a arcu imperdiet malesuada. Sed vel lectus. Donec odio urna, tempus molestie, porttitor ut, iaculis quis, sem. Pha', style: 'index'},\n    {text: ccpcm_global.print_projection([]), style: 'projection', margin: [0, 0, 0, 4]} ]},{text: 10, alignment: 'right', style:'indexPageNumber' }]); \n}*\/\n\n\nvar page_count = parseInt(_d.length \/ (row_per_page * 2));\n\nif ((_d.length % (row_per_page * 2)) \u003E 0)\n  page_count += 1;\nconsole.log('page_count', page_count);\n\nfor(var page = 0; page \u003C page_count; page++) {\n  var _d_elements = _d.slice(page * row_per_page * 2, page * row_per_page * 2 + row_per_page * 2);\n  var _d_col1 = _d_elements.slice(0,row_per_page);\n  var _d_col2 = _d_elements.slice(row_per_page,_d_elements.length);\n  console.log('_d_elements', _d_elements);\n  console.log('_d_col1', _d_col1);\n  console.log('_d_col2', _d_col2);\n  var col1 = [];\n  var col2 = [];\n\n  if (_d_col1.length) {\n    col1.push({\n          \/\/layout: 'noBorders', \/\/ optional\n          table: {\n            headerRows: 0,\n            widths: [ content_width\/2 - tableCell1, tableCell2],\n            body: _d_col1,\n          },\n          \/\/margin: [ccpcm_global.insideMargins[0],0,ccpcm_global.insideMargins[2],0],\n          layout: {\n            hLineWidth: function(i, node) { if (i != 0 )return borderBottomWidth; },\n            vLineWidth: function(i, node) { return 0; },\n            hLineColor: function (i, node) {return [0,0,0,10];},\n            \/\/vLineColor: function (i, node) {return 'blue';},\n            paddingLeft: function(i, node) { return 0; },\n            paddingRight: function(i, node) { return 0; },\n            paddingTop: function(i, node) { return 0; },\n            paddingBottom: function(i, node) { return 0; },\n          },\n    });\n  }\n\n  if (_d_col2.length) {\n    col2.push({\n          \/\/layout: 'noBorders', \/\/ optional\n          table: {\n            headerRows: 0,\n            widths: [ content_width\/2 - tableCell1, tableCell2],\n            body: _d_col2,\n          },\n          \/\/margin: [ccpcm_global.insideMargins[0],0,ccpcm_global.insideMargins[2],0],\n          layout: {\n            hLineWidth: function(i, node) { if (i != 0 )return borderBottomWidth; },\n            vLineWidth: function(i, node) { return 0; },\n            hLineColor: function (i, node) {return [0,0,0,10];},\n            \/\/vLineColor: function (i, node) {return 'blue';},\n            paddingLeft: function(i, node) { return 0; },\n            paddingRight: function(i, node) { return 0; },\n            paddingTop: function(i, node) { return 0; },\n            paddingBottom: function(i, node) { return 0; },\n          },\n    });\n  }\n  \n\/\/Afficher les legendes \n\nvar tableGap = 33;\nvar rowLegendHeight = 22;\nvar tableWidth =  ccpcm_global.pageSize.width - ccpcm_global.tabWidth - (ccpcm_global.cropMarksLength * 2);\nvar tableHeight =  ccpcm_global.pageSize.height - (ccpcm_global.cropMarksLength * 2)-tableGap;\nif (page == (page_count-1) ) {\ndd.push({\n      layout: 'noBorders', \/\/ optional\n      table: {\n        \/\/unbreakable : false, \n        dontBreakRows: false,\n        widths: [tableWidth\/2-ccpcm_global.masterMargins[3]+4],\n        heights: tableHeight,\n        body: [\n          [ \n          \/\/ Table in table\n         {\n        layout: 'noBorders', \/\/ optional\n        table: {\n          \/\/unbreakable : false, \n          dontBreakRows: false,\n          widths: ['100%'],\n          heights: [rowLegendHeight,rowLegendHeight-12,rowLegendHeight],\n          body: [\n            [ { columns: legends.slice(0, legends.length\/3), columnGap: 10, margin:[0,0,0,0], \/*fillColor:'pink'*\/} ],\n            [ { columns: legends.slice(legends.length\/3, legends.length\/3*2), columnGap: 10, margin:[0,0,0,0], \/*fillColor:'#F0FFFF'*\/} ],\n            [ { columns: legends.slice( legends.length\/3*2, legends.length), columnGap: 2, margin:[0,0,0,0], \/*fillColor:'pink'*\/} ],\n          ]\n        },\n           margin: [0,tableHeight-(rowLegendHeight*3)-ccpcm_global.masterMargins[1],0,0]\n      }\n            \n          ],\/\/fillColor:'pink',\n        ]\n      },\n  margin:[\n    tableWidth\/2+4,\n    -ccpcm_global.masterMargins[1],\n    0,\n    -tableHeight+ccpcm_global.masterMargins[1] \/\/ Hack du positionAbsolute\n  ], \n  \/\/pageBreak: 'after',\n});\n}\n console.log(legends); \n\/\/ #41\nif ( ccpcm_global.indexDisclaimer != '' ) \n  dd.push(\n  {\n    text: ccpcm_global.indexDisclaimer,\n    style: 'intertitre',\n    alignment: 'center',\n\tmargin: ccpcm_global.insideMargins,\n  });\n  \ndd.push(\n  {\n    columns:[col1,col2], \n       margin: [ccpcm_global.insideMargins[0],0,ccpcm_global.insideMargins[2]-8,0], \/\/#41 -8 Hack des new marges \n       pageBreak: 'after',\n\t\/\/ pageBreak: (page \u003C page_count - 1)?'after':null, \/\/ Ne pas mettre de pageBreak si FIN \n  });\n  \n} \/\/ Fin boucle \n\n\/\/Afficher les legendes \n\/*dd.push({\n  \/\/layout: 'noBorders',\n  layout: {\n    hLineWidth: function(i, node) { return 0; },\n    vLineWidth: function(i, node) { return 0; },\n    \/\/hLineColor: function (i, node) {return [0,0,0,0];},\n    \/\/vLineColor: function (i, node) {return 'blue';},\n    paddingLeft: function(i, node) { return 1; },\n    paddingRight: function(i, node) { return 1; },\n    paddingTop: function(i, node) { return 0; },\n    paddingBottom: function(i, node) { return 0; },\n  },\n  table: {\n    \/\/width: [ 10 ],\n    headerRows: 0,\n    body: [legends]\n  },\n  \/\/margin:[ccpcm_global.insideMargins[0],4,ccpcm_global.insideMargins[2],0],\n  absolutePosition: {x:ccpcm_global.insideMargins[0],y:ccpcm_global.pageSize.height-ccpcm_global.insideMargins[1]-40},\n  pageBreak: 'after',\n});*\/","type":"index","elements_count":"0","elements_ids":""}